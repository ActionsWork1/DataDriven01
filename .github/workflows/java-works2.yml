#name: Java Playwright Allure CI
#
#on:
#  push:
#    branches: [ main, develop ]
#  pull_request:
#  workflow_dispatch:
#
#jobs:
#  test:
#    runs-on: ${{ matrix.os }}
#    strategy:
#      matrix:
#        os: [ubuntu-latest] #, windows-latest, macos-latest]
#
#    steps:
#      - name: Checkout
#        uses: actions/checkout@v4
#
#      - name: Set up Java
#        uses: actions/setup-java@v4
#        with:
#          distribution: temurin
#          java-version: '21'
#          cache: maven   # Maven dependency cache (cross-platform)
#
#      - name: Cache Playwright Browsers
#        uses: actions/cache@v4
#        with:
#          path: |
#            ~/.cache/ms-playwright
#            ~/Library/Caches/ms-playwright
#            %USERPROFILE%\AppData\Local\ms-playwright
#          key: ${{ runner.os }}-playwright-${{ hashFiles('**/pom.xml') }}
#          restore-keys: |
#            ${{ runner.os }}-playwright-
#
#      - name: Install Playwright Browsers
#        if: steps.playwright-cache.outputs.cache-hit != 'true'
#        run: mvn exec:java -e -D exec.mainClass=com.microsoft.playwright.CLI -D exec.args="install chromium --with-deps"
#
#      - name: Run Tests
#        run: mvn test
#        continue-on-error: true
#
#      - name: Load Allure History
#        if: always()
#        uses: actions/checkout@v4
#        with:
#          ref: gh-pages
#          path: gh-pages
#        continue-on-error: true
#
#      - name: Restore Allure History
#        if: always()
#        run: |
#          mkdir -p allure-results/history
#          cp -r gh-pages/history/* allure-results/history/ || true
#        shell: bash
#
#      - name: Generate Allure Report
#        if: always()
#        uses: simple-elf/allure-report-action@master
#        with:
#          allure_results: ./allure-results
#          allure_report: allure-report
#          gh_pages: gh-pages
#          keep_reports: 20
#
#      - name: Publish Allure Report to GitHub Pages
#        if: always()
#        uses: peaceiris/actions-gh-pages@v4
#        with:
#          github_token: ${{ secrets.GITHUB_TOKEN }}
#          publish_dir: gh-pages
